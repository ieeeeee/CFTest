@{
    /**/

    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section headerJS{
    <script src="~/Content/FrameTheme/js/cbpFWTabs.js"></script>
    <style>
        .buttons-ui {
            text-align: left;
        }

        .graph {
            padding: 1em 1em;
        }

        .tabs nav li.tab-current {
            border: none;
            box-shadow: none;
            border-bottom: 2px solid #05ba5a;
        }

        .tabs nav ul li {
            border: none;
        }

        .tabs nav li.tab-current:before, .tabs nav li.tab-current:after {
            background: #cccccc;
        }

        .tabs nav li.tab-current a {
            color: #05ba5a;
        }

        .tabs nav a {
            color: #333333;
            padding: 0 1.0em;
        }
        .tabs nav ul{
            float:left;
        }
    </style>
}

<div class="sub-heard-part">
    <ol class="breadcrumb m-b-0">
        <li><a href="#">Home</a></li>
        <li class="active">Index</li>
    </ol>
</div>
<div class="tab-main">
    <div class="tab-inner">
        <div id="tabs" class="tabs">
            @*<h2 class="inner-tittle">Responsive Horizontal Tabs </h2>*@
            <div class="graph">
                <nav>
                    <ul>
                        <li><a href="#section-1" class="icon-shop"> <span>工作记录</span></a></li>
                        <li><a href="#section-2" class="icon-cup"> <span>由我创建</span></a></li>
                        <li><a href="#section-3" class="icon-food"> <span>待我审核</span></a></li>
                        <li><a href="#section-4" class="icon-lab"><span>由我完成</span></a></li>
                        <li><a href="#section-5" class="icon-truck"><span>由我关闭</span></a></li>
                    </ul>
                </nav>
                <div class="content tab">
                    <section id="section-1">
                        <div class="graph" id="listControl-1">
                            <div class="tables" id="modelInfoList">
                                <table class="table table-hover">
                                    <thead><tr><th>2018-06</th></tr> </thead>
                                    <tbody v-for="(item,index) in modelInfoList">
                                        <tr>
                                            <td><input class="Subcb" :data-id="item.PlanID" type="checkbox" /></td>
                                            <td>{{item.PlanID}}</td>
                                            <td>{{item.PlanTitle}}</td>
                                            <td>{{item.PlanType}}</td>
                                            <td>{{item.Operator}}</td>
                                            <td>{{item.IsDeleted}}</td>
                                            <td>
                                                <a id="btnAdd" style="color:#55acee;" v-on:click="EditModel(index,item.PlanID)"><i class="fa fa-edit" title="编辑"></i>&nbsp;</a>
                                                <a id="btnDel" style="color:#e74c3c;" v-on:click="DelData(index,item.PlanID)"><i class="fa fa-close" title="删除"></i>&nbsp;&nbsp;</a>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <thead><tr><th>2018-05</th></tr> </thead>
                                    <tbody v-for="(item,index) in modelInfoList">
                                        <tr>
                                            <td><input class="Subcb" :data-id="item.PlanID" type="checkbox" /></td>
                                            <td>{{item.PlanID}}</td>
                                            <td>{{item.PlanTitle}}</td>
                                            <td>{{item.PlanType}}</td>
                                            <td>{{item.Operator}}</td>
                                            <td>{{item.IsDeleted}}</td>
                                            <td>
                                                <a id="btnAdd" style="color:#55acee;" v-on:click="EditModel(index,item.PlanID)"><i class="fa fa-edit" title="编辑"></i>&nbsp;</a>
                                                <a id="btnDel" style="color:#e74c3c;" v-on:click="DelData(index,item.PlanID)"><i class="fa fa-close" title="删除"></i>&nbsp;&nbsp;</a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-xs-12 text-center" v-if="modelInfoList.length<=0 ">
                                {{message}}
                            </div>
                            <div class="row" id="pageDiv">
                                <div class="col-xs-12">
                                    <hr style="margin:10px auto;" />
                                    <div id="pager" style="margin-top:4px;"></div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section id="section-2">
                        <div class="mediabox">
                            <i class="fa fa-trophy"></i>
                            <h3>Asparagus Cucumber Cake</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                        <div class="mediabox">
                            <i class="fa fa-coffee"></i>
                            <h3>Magis Kohlrabi Gourd</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                        <div class="mediabox">
                            <i class="fa fa-leaf"></i>
                            <h3>Ricebean Rutabaga</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                    </section>
                    <section id="section-3">
                        <div class="mediabox">
                            <i class="fa fa-leaf"></i>
                            <h3>Noodle Curry</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                        <div class="mediabox">
                            <i class="fa fa-trophy"></i>
                            <h3>Leek Wasabi</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                        <div class="mediabox">
                            <i class="fa fa-coffee"></i>
                            <h3>Green Tofu Wrap</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                    </section>
                    <section id="section-4">
                        <div class="mediabox">
                            <i class="fa fa-trophy"></i>
                            <h3>Tomato Cucumber Curd</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                        <div class="mediabox">
                            <i class="fa fa-coffee"></i>
                            <h3>Mushroom Green</h3>
                            <p>Salsify taro catsear garlic gram celery bitterleaf wattle seed collard greens nori. Grape wattle seed kombu beetroot horseradish carrot squash brussels sprout chard.</p>
                        </div>
                        <div class="mediabox">
                            <i class="fa fa-leaf"></i>
                            <h3>Swiss Celery Chard</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                    </section>
                    <section id="section-5">
                        <div class="mediabox">
                            <i class="fa fa-leaf"></i>
                            <h3>Radish Tomato</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                        <div class="mediabox">
                            <i class="fa fa-trophy"></i>
                            <h3>Fennel Wasabi</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                        <div class="mediabox">
                            <i class="fa fa-coffee"></i>
                            <h3>Red Tofu Wrap</h3>
                            <p>Chickweed okra pea winter purslane coriander yarrow sweet pepper radish garlic brussels sprout groundnut summer purslane earthnut pea tomato spring onion azuki bean gourd. </p>
                        </div>
                    </section>
                </div><!-- /content -->
            </div>
            <!-- /tabs -->

        </div>
    </div>
</div>
@section pageJS{
    <link href="~/Content/Plugin/layui/css/layui.css" rel="stylesheet" />
    <script src="~/Content/Plugin/layui/layui.all.js"></script>
    <script src="~/Content/Plugin/vue.js"></script>
    <script type="text/javascript">
        $(function () {
            new CBPFWTabs(document.getElementById('tabs'));
            var vList = new Vue({
                el: "#listControl-1",
                data: {
                    pageSize: 6,
                    pageIndex: 1,
                    modelInfoList: [],
                    message: "没有数据",
                    searchKeyWords: ""
                },
                methods: {
                    AddModel: function () {
                        return GetAddModel();
                    },
                    EditModel: function (index, ID) {
                        return GetEditModel(index, ID);
                    },
                    DelData: function (index, ID) {
                        return GetDelData(index, ID);
                    },
                    Search: function (searchKeyWords) {
                        return GetSearch(searchKeyWords);
                    }
                }
             })
             var modelFilter = {};
              modelFilter.rows = pageGlobalParam.pageSize;
              modelFilter.page = pageGlobalParam.currPage;
              modelFilter.keywords = vList.searchKeyWords;
              GetModelInfo(modelFilter);

        //获取分页菜单信息
            function GetModelInfo(Filter) {
                //console.log(menuFilter);
                $.post("/PlanList/GetAllPlanInfo", Filter, function (result) {
                    console.log(result);
                    if (result) {
                        vList.modelInfoList = result.rows;
                        if (result.rows.length > 0) {
                            $("#pageDiv").show();
                            layui.use('laypage', function () {
                                var laypage = layui.laypage;
                                laypage.render({
                                    elem: 'pager'
                                    , count: result.records
                                    ,curr:result.page
                                    , layout: ['count', 'prev', 'page', 'next', 'limit', 'skip']
                                    , groups: 1
                                    , first: false
                                    ,last:false
                                    , jump: function (obj, first) {
                                        if (!first) {
                                            //pageGlobalParam.currPage = obj.curr;
                                            //pageGlobalParam.pageSize = obj.limit;
                                            modelFilter.rows = obj.limit;
                                            modelFilter.page = obj.curr;
                                            GetModelInfo(modelFilter);
                                        }
                                    }
                                });
                            });
                            } else {
                            $("#pageDiv").hide()
                            }
                    }
                },"json");

                }

            $(".Allcb").click(function () {
                    $(this).closest("table").find("td [type=checkbox]").prop('checked', $(this).prop('checked'));
                })


        //添加 新开页面
        function GetAddModel() {
            $("#btnAdd").button("loading");
            window.location.href = "@Url.Action("Add")" + "?id=0";
        }
            //编辑 layer
            function GetEditModel(index, ID) {
                //layer.open({
                //    type: 2, //表示Frame层
                //    title: '编辑',
                //    shadeClose: false,
                //    shade: 0.8,
                //    area: ['60%', '50%'],
                //    content: '/MenuInfo/Add?menuID=' + MenuID,
                //    end: function () {
                //        GetMenuInfo(10, 1);
                //    }
                //});
                window.location.href = "@Url.Action("Add")" + "?id=" + ID;
            }

            //查找
            function GetSearch(searchKeyWords) {
                modelFilter.keywords = searchKeyWords;
                GetModelInfo(modelFilter);
            }
            //删除
            function GetDelData(index, ID) {
                var ids = [];
                if (index != -1) {
                    ids.push(ID);
                }
                else {
                    $("#modelInfoList table tbody tr td").find("input[type=checkbox]").each(function (i,item) {
                        if ($(item).is(':checked')) {
                            ids.push(item.getAttribute("data-id"));
                        }

                    })
                }
                //console.log(ids);
                //layer询问框
                layer.confirm('确定删除吗?', { icon: 3, title: '提示' }, function (index) {
                    //确定
                    $.post("/PlanList/Del", { "ids": ids }, function (result) {
                        if (result) {
                            if (result.flag) {
                                layer.msg("删除成功!");
                                $("#modelInfoList table tbody tr td").find("input[type=checkbox]").prop("checked", false);
                                GetModelInfo(modelFilter);
                            }
                            else {
                                layer.msg("删除失败!");
                            }
                        }
                    })
                    //关闭询问框
                    layer.close(index);
                });
            }
        })

    </script>
}